# Q 脑量化交易系统 - TODO Task List
# 最后更新：2026-03-01 23:10
# 版本：20260301-v5 - P3 系统重构启动

## 🎯 当前任务状态

### ✅ P0-P2 - 已完成 (100%)
- [x] P0: 5005 端口修复、飞书排查
- [x] P1: 监控面板开发 (Tools 状态 + 飞书监控)
- [x] P2: 品牌命名、文档完善

### 🔄 P3 - 系统重构 (进行中 - 0%)

#### 子任务分解：

**1. 数据层重构** 
- [ ] 统一数据接口 `src/data_provider.py`
- [ ] 缓存层 `src/data_cache.py`
- [ ] 单元测试 `tests/test_data_provider.py`
- 👉 **负责人**: Dev-Agent (doubao-seed-2.0-code)
- 📊 状态：🔄 进行中

**2. 选股引擎开发**
- [ ] 四层漏斗筛选器 `src/stock_screener.py`
- [ ] 筛选器模块 `src/filters/*.py`
- [ ] 配置文件 `config/screener_config.yaml`
- 👉 **负责人**: Factor-Agent (doubao-seed-2.0-code)
- 📊 状态：🔄 进行中

**3. 风控与执行层**
- [ ] Kelly 仓位管理 `src/risk_manager.py`
- [ ] 仓位管理器 `src/position_manager.py`
- [ ] 订单执行器 `src/order_executor.py`
- [ ] 风控配置 `config/risk_config.yaml`
- 👉 **负责人**: Risk-Agent (doubao-seed-2.0-code)
- 📊 状态：🔄 进行中

**4. 回测验证**
- [ ] 批量回测引擎 `src/batch_backtester.py`
- [ ] 绩效分析器 `src/performance_analyzer.py`
- [ ] A 股 ETF 批量回测 (2024-2026)
- [ ] 回测分析报告
- 👉 **负责人**: Backer-Agent (doubao-seed-2.0-code)
- 📊 状态：🔄 进行中

---

## 📊 Agent 任务分配表

| Agent | 模型 | 任务 | 状态 | 预计耗时 |
|-------|------|------|------|---------|
| Dev-Agent | doubao-seed-2.0-code | 数据层重构 | 🔄 进行中 | 30 分钟 |
| Factor-Agent | doubao-seed-2.0-code | 选股引擎 | 🔄 进行中 | 30 分钟 |
| Risk-Agent | doubao-seed-2.0-code | 风控执行层 | 🔄 进行中 | 30 分钟 |
| Backer-Agent | doubao-seed-2.0-code | 回测验证 | 🔄 进行中 | 30 分钟 |
| Archie | qwen3.5-plus | 架构审核 | ⏳ 待命 | - |
| Testy | doubao-seed-2.0-code | 集成测试 | ⏳ 待命 | - |
| 小七 (主控) | qwen3.5-plus | 协调整合 | ✅ 进行中 | - |

---

## 📁 预计新增文件清单

```
stock-trading/
├── src/
│   ├── data_provider.py          # 统一数据接口 ⭐
│   ├── data_cache.py             # 缓存层 ⭐
│   ├── stock_screener.py         # 选股引擎 ⭐
│   ├── filters/
│   │   ├── base_filter.py        # 基础筛选器
│   │   ├── fundamental_filter.py # 财务质量筛选
│   │   ├── factor_filter.py      # 因子评分筛选
│   │   └── technical_filter.py   # 技术面筛选
│   ├── risk_manager.py           # 风控管理 ⭐
│   ├── position_manager.py       # 仓位管理 ⭐
│   ├── order_executor.py         # 订单执行 ⭐
│   └── batch_backtester.py       # 批量回测 ⭐
├── config/
│   ├── screener_config.yaml      # 选股配置 ⭐
│   └── risk_config.yaml          # 风控配置 ⭐
├── tests/
│   ├── test_data_provider.py     # 数据层测试
│   ├── test_screener.py          # 选股引擎测试
│   └── test_risk_manager.py      # 风控测试
└── results/
    └── etf_batch_results/        # ETF 回测结果 ⭐
```

---

## 🚀 开发流程

1. **并行开发** → 4 个 Agent 同时开发各自模块
2. **小版本提交** → 每完成一个模块就 commit
3. **集成测试** → Testy-Agent 进行集成测试
4. **架构审核** → Archie 审核代码质量
5. **合并部署** → 合并到 main 分支，部署到阿里云

---

## ⏰ 时间规划

- **23:10** - 启动 4 个并行 Agent ✅
- **23:40** - 各 Agent 完成开发 (预计)
- **23:50** - 集成测试完成
- **00:00** - 代码审核通过
- **00:10** - 合并部署完成

---

## 📝 注意事项

1. 所有代码 Agent 使用 **doubao-seed-2.0-code** 模型
2. 策略/决策 Agent 使用 **qwen3.5-plus** 模型
3. 每个 commit 都要有清晰的 message
4. 遇到问题及时汇报，不要卡住
5. 保持代码风格一致，遵循现有规范

---

## 🎯 成功标准

- [ ] 所有模块通过单元测试
- [ ] 集成测试通过率 > 95%
- [ ] 代码审核无重大问题
- [ ] 部署后服务正常运行
- [ ] 回测结果符合预期
